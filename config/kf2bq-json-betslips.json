{
  "id": "schemaname",
  "name": "schemaname",
  "version": "version1",
  "schemas": [
    {
      "type": "json",
      "id": "jsonschema1",
      "name": "jsonschema1Name",
      "version": "version1",
      "definition": {
        "type": "jsondefinition",
        "name": "BetSlip",
        "fields": [
          {
            "mode": "required",
            "name": "data",
            "type": "record",
            "fields": [
              {
                "mode": "nullable",
                "name": "terminalId",
                "type": "String"
              },
              {
                "mode": "nullable",
                "name": "storeId",
                "type": "String"
              },
              {
                "mode": "nullable",
                "name": "userId",
                "type": "String"
              },
              {
                "mode": "required",
                "name": "content",
                "type": "record",
                "fields": [
                  {
                    "mode": "required",
                    "name": "id",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "alien",
                    "type": "Boolean"
                  },
                  {
                    "mode": "nullable",
                    "name": "alienExpectedResultDate",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "alienOtherReason",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "alienReason",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "barcodeNumber",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "betLegTotal",
                    "type": "Double"
                  },
                  {
                    "mode": "nullable",
                    "name": "blockedPayment",
                    "type": "Boolean"
                  },
                  {
                    "mode": "nullable",
                    "name": "cancelled",
                    "type": "Boolean"
                  },
                  {
                    "mode": "nullable",
                    "name": "cancelledByStoreId",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "cancelledByTerminalId",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "cancelledByUserId",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "cancelledByUserName",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "colleagueVerifier",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "connectCardNumber",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "connectCardPIN",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "connectCardUID",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "connectCardUsername",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "customerId",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateCancelled",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateCreated",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "datePaidOut",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateScanned",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateSettled",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateStruck",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateTranslated",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "dateUpdated",
                    "type": "Long"
                  },
                  {
                    "mode": "nullable",
                    "name": "image",
                    "type": "String"
                  },
                  {
                    "mode": "nullable",
                    "name": "imageUrl",
                    "type": "String"
                  }
                ]
              }
            ]
          },
          {
            "mode": "required",
            "name": "`type`",
            "type": "String"
          }
        ]
      }
    }
  ],
  "lookups": [],
  "taps": [
    {
      "type": "kafka",
      "id": "kafkasource1",
      "bootstrap": "internal-coral-epos2-stg0-kafka-lb-998826191.eu-west-2.elb.amazonaws.com:9092",
      "topic": "betslips",
      "group": "pai-betslip-group",
      "defaultOffset": "latest",
      "autoCommit": false
    },
    {
      "type": "bigquery",
      "id": "bigquerysource1",
      "dataset": "coral_retail_stg_omnia_betslips",
      "table": "betslips",
      "createDisposition": "CREATE_IF_NEEDED",
      "writeDisposition": "WRITE_APPEND"
    }
  ],
  "steps": [
    {
      "type": "source",
      "id": "in",
      "name": "in",
      "schema": "jsonschema1",
      "tap": "kafkasource1"
    },
    {
      "type": "transformation",
      "id": "add-timestamp",
      "name": "addTimestamp",
      "op": "map",
      "params": [["m => { val t = Helper.fmt.print(Helper.Instant.now()); m.append('ts, t) }"]],
      "paramsEncoded": false
    },
    {
      "type": "sink",
      "id": "out",
      "name": "out",
      "tap": "bigquerysource1"
    }
  ],
  "dag": [
    {
      "from": "in",
      "to": "add-timestamp"
    },
    {
      "from": "add-timestamp",
      "to": "out"
    }
  ]
}