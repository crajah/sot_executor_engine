{
  "name": "schemaname",
  "version": "version1",
  "schemas": [
    {
      "type": "protobuf",
      "id": "protobet",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "Bet",
        "fields": [
          {
            "mode": "required",
            "type": "String",
            "name": "id"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protobetslip",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "BetSlip",
        "fields": [
          {
            "mode": "required",
            "type": "String",
            "name": "id"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protobetstate",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "BetState",
        "fields": [
          {
            "mode": "optional",
            "name": "bet",
            "type": "Bet"
          },
          {
            "mode": "repeated",
            "name": "bets",
            "type": "Bet"
          },
          {
            "mode": "optional",
            "name": "betSlip",
            "type": "BetSlip"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protoactivitydescriptor",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "ActivityDescriptor",
        "fields": [
          {
            "mode": "required",
            "name": "id",
            "type": "Int"
          },
          {
            "mode": "required",
            "name": "name",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "description",
            "type": "String"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protomonitoring",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "Monitoring",
        "fields": [
          {
            "mode": "optional",
            "name": "initializeAtCollector",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "beforeSubmitToComposer",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "startComposerQuery",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "endComposerQuery",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "orchestratorReceive",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "orchestratorSend",
            "type": "Long"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protosequencingdescriptor",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "SequencingDescriptor",
        "fields": [
          {
            "mode": "required",
            "name": "id",
            "type": "Int"
          },
          {
            "mode": "required",
            "name": "name",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "description",
            "type": "String"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protosequencingkey",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "SequencingKey",
        "fields": [
          {
            "mode": "optional",
            "name": "sequencingDescriptor",
            "type": "SequencingDescriptor"
          },
          {
            "mode": "optional",
            "name": "sequencingId",
            "type": "Int"
          }
        ]
      }
    },
    {
      "type": "protobuf",
      "id": "protoheader",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "ActivityHeader",
        "fields": [
          {
            "mode": "required",
            "name": "activityId",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "timeStamp",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "crudType",
            "type": "CrudType"
          },
          {
            "mode": "optional",
            "name": "sequencingKey",
            "type": "SequencingKey"
          },
          {
            "mode": "optional",
            "name": "queueId",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "payload",
            "type": "_root_.com.google.protobuf.ByteString"
          },
          {
            "mode": "optional",
            "name": "uniqueId",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "activityDescriptor",
            "type": "ActivityDescriptor"
          },
          {
            "mode": "optional",
            "name": "firstSentTime",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "sendRetries",
            "type": "Long"
          },
          {
            "mode": "optional",
            "name": "contextRef",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "publisherRef",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "monitoring",
            "type": "Monitoring"
          },
          {
            "mode": "optional",
            "name": "operatorRef",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "operatorName",
            "type": "String"
          },
          {
            "mode": "optional",
            "name": "correlationId",
            "type": "Long"
          }
        ],
        "doc": "A basic schema for storing user records"
      }
    },
    {
      "type": "protobuf",
      "id": "protoschema1",
      "version": "version2",
      "definition": {
        "type": "protobufdefinition",
        "name": "Activity",
        "fields": [
          {
            "mode": "required",
            "name": "header",
            "type": "ActivityHeader"
          },
          {
            "mode": "optional",
            "name": "state",
            "type": "BetState"
          }
        ],
        "doc": "A basic schema for storing user records"
      }
    },
    {
      "type": "bigquery",
      "id": "bigqueryschema1",
      "version": "version3",
      "definition": {
        "type": "bigquerydefinition",
        "name": "BigQueryRow",
        "fields": [
          {
            "mode": "REQUIRED",
            "name": "header",
            "type": "RECORD",
            "fields": [
              {
                "mode": "REQUIRED",
                "name": "activityId",
                "type": "INTEGER"
              },
              {
                "mode": "NULLABLE",
                "name": "timeStamp",
                "type": "INTEGER"
              },
              {
                "mode": "NULLABLE",
                "name": "crudType",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "sequencingKey",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "NULLABLE",
                    "name": "sequencingDescriptor",
                    "type": "RECORD",
                    "fields": [
                      {
                        "mode": "REQUIRED",
                        "name": "id",
                        "type": "INTEGER"
                      },
                      {
                        "mode": "REQUIRED",
                        "name": "name",
                        "type": "STRING"
                      },
                      {
                        "mode": "NULLABLE",
                        "name": "description",
                        "type": "STRING"
                      }
                    ]
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "sequencingId",
                    "type": "INTEGER"
                  }
                ]
              },
              {
                "mode": "NULLABLE",
                "name": "queueId",
                "type": "INTEGER"
              },
              {
                "mode": "NULLABLE",
                "name": "payload",
                "type": "BYTES"
              },
              {
                "mode": "NULLABLE",
                "name": "uniqueId",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "activityDescriptor",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "REQUIRED",
                    "name": "id",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "REQUIRED",
                    "name": "name",
                    "type": "STRING"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "description",
                    "type": "STRING"
                  }
                ]
              },
              {
                "mode": "NULLABLE",
                "name": "firstSentTime",
                "type": "INTEGER"
              },
              {
                "mode": "NULLABLE",
                "name": "sendRetries",
                "type": "INTEGER"
              },
              {
                "mode": "NULLABLE",
                "name": "contextRef",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "publisherRef",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "monitoring",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "NULLABLE",
                    "name": "initializeAtCollector",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "beforeSubmitToComposer",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "startComposerQuery",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "endComposerQuery",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "orchestratorReceive",
                    "type": "INTEGER"
                  },
                  {
                    "mode": "NULLABLE",
                    "name": "orchestratorSend",
                    "type": "INTEGER"
                  }
                ]
              },
              {
                "mode": "NULLABLE",
                "name": "operatorRef",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "operatorName",
                "type": "STRING"
              },
              {
                "mode": "NULLABLE",
                "name": "correlationId",
                "type": "INTEGER"
              }
            ]
          },
          {
            "mode": "NULLABLE",
            "name": "state",
            "type": "RECORD",
            "fields": [
              {
                "mode": "NULLABLE",
                "name": "bet",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "REQUIRED",
                    "name": "id",
                    "type": "STRING"
                  }
                ]
              },
              {
                "mode": "REPEATED",
                "name": "bets",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "REQUIRED",
                    "name": "id",
                    "type": "STRING"
                  }
                ]
              },
              {
                "mode": "NULLABLE",
                "name": "betSlip",
                "type": "RECORD",
                "fields": [
                  {
                    "mode": "REQUIRED",
                    "name": "id",
                    "type": "STRING"
                  }
                ]
              }
            ]
          }
        ]
      }
    }
  ],
  "taps": [
    {
      "type": "pubsub",
      "id": "pubsubsource1",
      "topic": "bets-prod"
    },
    {
      "type": "bigquery",
      "id": "bigquerysource1",
      "dataset": "bigquerytest",
      "table": "bets_prod"
    }
  ],
  "steps": [
    {
      "type": "source",
      "name": "in",
      "schema": "protoschema1",
      "source": "pubsubsource1"
    },
    {
      "type": "sink",
      "name": "out",
      "schema": "bigqueryschema1",
      "source": "bigquerysource1"
    }
  ],
  "dag": [
    {
      "from": "in",
      "to": "out"
    }
  ]
}